---
title: "mbd derivation"
author: "Richel J.C. Bilderbeek"
header-includes:
   - \usepackage{bbm}
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{mbd derivation}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

Likelihood:

$$
L = L_{branches} \cdot L_{nodes}
$$

## 1. A operator

The A operator is given by the integration of a set of differential equations
between two consecutive nodes. So, defined the set in the time interval
$[t_{i-1}, t_i]$, where k species are present in the phylogeny, as:

$$
\frac{d}{dt}Q^k_m(t) = \Sigma_n(M^k_m,n \cdot Q^k_n(t))
dt
$$
where m, n, label the amount of unseen species in the phylogeny,
A is thus defined as:

$$
A(t_i - t_{i-1}) = e^{M(t_k - t_{k-1})}
$$

From R:

```{r}
a <- mbd::a_operator(
  q_matrix = c(1),
  transition_matrix = c(1),
  time_interval = 0.1
)
```

### 1.1 Q equation

### 1.2 n- and k-pool speciations

### 1.3 Q equation: matrix form

## 2. B operator

### 