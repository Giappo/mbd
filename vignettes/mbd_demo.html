<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Giovanni Laudanno" />

<meta name="date" content="2018-08-09" />

<title>Using MBD</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using MBD</h1>
<h4 class="author"><em>Giovanni Laudanno</em></h4>
<h4 class="date"><em>2018-08-09</em></h4>



<div id="mbd-introduction" class="section level2">
<h2>MBD introduction</h2>
<p>MBD is a package to support multiple birth model. This model accounts for a diversification process in which multiple birth (at different nodes) are allowed to occur at the same time. The basic framework is described in Etienne et al. 2012<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. The main purpose of the package is to provide a tool to estimate, given a phylogenetic tree, the likelihood for a set of three parameters: <span class="math inline">\(\lambda\)</span>,<span class="math inline">\(\mu\)</span> and <span class="math inline">\(q\)</span>. Here:</p>
<ul>
<li><p><span class="math inline">\(\lambda\)</span> is the sympatric speciation rate;</p></li>
<li><p><span class="math inline">\(\mu\)</span> is the extinction rate;</p></li>
<li><p><span class="math inline">\(\nu\)</span> is the multiple allopatric speciation trigger rate;</p></li>
<li><p><span class="math inline">\(q\)</span> is the single-lineage speciation probability.</p></li>
</ul>
<p>Those parameters may be inferred through a maximum likelihood approach using the function mbd_ML.</p>
</div>
<div id="mbd-usage" class="section level2">
<h2>MBD usage</h2>
<p>First clear memory and load the package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>()); <span class="kw">options</span>(<span class="dt">warn =</span> <span class="op">-</span><span class="dv">1</span>);
<span class="kw">suppressWarnings</span>( <span class="kw">suppressPackageStartupMessages</span>( <span class="kw">library</span>(MBD) ) )</code></pre></div>
<p>Then we set some basic parameters to create a simulated tree:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">14</span>) <span class="co">#set.seed(42)</span>
sim_pars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="dv">2</span>, <span class="fl">0.1</span>); soc &lt;-<span class="st"> </span><span class="dv">2</span>; cond &lt;-<span class="st"> </span><span class="dv">1</span>; age &lt;-<span class="st"> </span><span class="dv">10</span>;<span class="co">#sim_pars &lt;- c(0.2, 0.1, 1.5, 0.1); soc = 2; cond = 1; age = 10;</span>
sim &lt;-<span class="st"> </span>MBD<span class="op">:::</span><span class="kw">mbd_sim</span>(<span class="dt">pars =</span> sim_pars, <span class="dt">soc =</span> soc, <span class="dt">age =</span> age, <span class="dt">cond =</span> cond, <span class="dt">tips_interval =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="ot">Inf</span>))</code></pre></div>
<p>Here “sim_pars” are <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\nu\)</span> and <span class="math inline">\(q\)</span>, i.e. the parameters we want to eventually be able to infer. There are also additional auxilary parameters such as “soc” (equal to 1 if we want a stem, or 2 if we want a crown), “cond” (let us condition the tree on the survival of crown species) and “age” (being the total age of the tree).</p>
<p>The “sim” list contain different objects. You can visualize the full tree and keep track of species that die before present time (missing species):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(sim<span class="op">$</span>tas)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If you want you can also show the reconstrucred tree, obtained cutting the kinks from the previous tree:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(sim<span class="op">$</span>tes)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The dataframe containing all the information related to this tree is labeled as L (or L-table). You can access it by typing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim<span class="op">$</span>L</code></pre></div>
<pre><code>##               [,1] [,2] [,3]       [,4]
##  [1,] 10.000000000    0   -1  6.3487294
##  [2,] 10.000000000   -1    2  7.2993068
##  [3,]  9.737302924    2    3  8.4680364
##  [4,]  9.602714721    3    4  4.4439626
##  [5,]  9.277554144    3    5  2.7370716
##  [6,]  8.985060585    4    6  0.6108607
##  [7,]  8.863148122    4    7  5.7864186
##  [8,]  8.778993524   -1   -8  3.5716189
##  [9,]  8.760931455    7    9  5.6426084
## [10,]  8.715808155    4   10  8.1973309
## [11,]  8.715808155    9   11  7.5673061
## [12,]  8.715808155   -8  -12  4.1374586
## [13,]  7.702370981   -1  -13  2.0938899
## [14,]  7.693443449    6   14 -1.0000000
## [15,]  7.334925204   -8  -15  2.8398438
## [16,]  7.301141852   14   16  4.1248310
## [17,]  7.301141852   -8  -17 -1.0000000
## [18,]  7.253830455   16   18 -1.0000000
## [19,]  7.143588437    4   19  4.7025871
## [20,]  6.885325448   18   20 -1.0000000
## [21,]  6.885325448  -15  -21  1.5991773
## [22,]  6.105321605    6   22 -1.0000000
## [23,]  6.105321605  -21  -23  4.7530645
## [24,]  5.833642032  -12  -24 -1.0000000
## [25,]  5.518919726   -8  -25 -1.0000000
## [26,]  5.425160410  -24  -26 -1.0000000
## [27,]  5.214845669   22   27 -1.0000000
## [28,]  5.012159993  -25  -28 -1.0000000
## [29,]  5.012159993  -23  -29 -1.0000000
## [30,]  4.569681042  -13  -30 -1.0000000
## [31,]  4.569681042  -12  -31  4.3234562
## [32,]  4.526436321  -26  -32 -1.0000000
## [33,]  4.397935422   20   33  3.9979325
## [34,]  4.185289924    5   34  2.6462100
## [35,]  4.128412268  -15  -35  1.7811912
## [36,]  4.128412268   14   36 -1.0000000
## [37,]  4.128412268  -17  -37  2.7358421
## [38,]  4.043504885   34   38  1.8920706
## [39,]  3.447542944   34   39  2.2873072
## [40,]  3.358437523  -32  -40 -1.0000000
## [41,]  3.167847807  -28  -41 -1.0000000
## [42,]  2.748298632  -37  -42  0.5086438
## [43,]  2.514770117   38   43  0.8397379
## [44,]  2.415129642   18   44 -1.0000000
## [45,]  2.312815861  -13  -45 -1.0000000
## [46,]  2.141405727  -13  -46  0.7644085
## [47,]  1.903355544  -41  -47 -1.0000000
## [48,]  1.574316412  -25  -48 -1.0000000
## [49,]  1.486270911  -40  -49  0.7485535
## [50,]  1.302014031  -41  -50 -1.0000000
## [51,]  1.302014031  -32  -51 -1.0000000
## [52,]  1.302014031   22   52 -1.0000000
## [53,]  1.302014031   36   53 -1.0000000
## [54,]  1.099113729  -24  -54 -1.0000000
## [55,]  1.094413355   36   55 -1.0000000
## [56,]  1.065485310   20   56 -1.0000000
## [57,]  1.045858253  -17  -57 -1.0000000
## [58,]  1.030235517  -25  -58 -1.0000000
## [59,]  1.030235517   53   59 -1.0000000
## [60,]  1.030235517  -57  -60 -1.0000000
## [61,]  1.030235517  -45  -61 -1.0000000
## [62,]  0.823777625  -28  -62 -1.0000000
## [63,]  0.731914514  -24  -63 -1.0000000
## [64,]  0.653801469  -40  -64 -1.0000000
## [65,]  0.546579355  -47  -65 -1.0000000
## [66,]  0.364948241   55   66 -1.0000000
## [67,]  0.364948241   53   67 -1.0000000
## [68,]  0.364948241  -24  -68 -1.0000000
## [69,]  0.364948241  -51  -69 -1.0000000
## [70,]  0.364948241  -45  -70 -1.0000000
## [71,]  0.364948241  -50  -71 -1.0000000
## [72,]  0.267419937   66   72  0.1961758
## [73,]  0.267419937   20   73 -1.0000000
## [74,]  0.267419937  -70  -74 -1.0000000
## [75,]  0.009137621  -65  -75 -1.0000000
## [76,]  0.003229247  -61  -76 -1.0000000</code></pre>
<p>In this table:</p>
<ul>
<li><p>the first column are the times at which species are born;</p></li>
<li><p>the second contains labels of the species’ parents; positive and negative values only indicate whether the species belongs to the left or right crown lineage;</p></li>
<li><p>the third contains the labels of the daughter species themselves; positive and negative values only indicate whether the species belongs to the left or right crown lineage;</p></li>
<li><p>the fourth contains the extinction times of the species. If this is equal to -1, then the species is still extant.</p></li>
</ul>
<p>To recover the vector of branching times use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim<span class="op">$</span>brts</code></pre></div>
<pre><code>##  [1] -10.000000000  -8.778993524  -8.715808155  -7.693443449  -7.334925204
##  [6]  -7.301141852  -7.301141852  -6.885325448  -5.425160410  -5.214845669
## [11]  -5.012159993  -4.569681042  -4.526436321  -4.128412268  -3.358437523
## [16]  -3.167847807  -2.415129642  -1.903355544  -1.574316412  -1.302014031
## [21]  -1.302014031  -1.302014031  -1.302014031  -1.099113729  -1.094413355
## [26]  -1.065485310  -1.045858253  -1.030235517  -1.030235517  -1.030235517
## [31]  -1.030235517  -0.823777625  -0.731914514  -0.653801469  -0.546579355
## [36]  -0.364948241  -0.364948241  -0.364948241  -0.364948241  -0.364948241
## [41]  -0.364948241  -0.267419937  -0.267419937  -0.009137621  -0.003229247</code></pre>
<p>In this vector values repeated more than once indicate that a multiple birth process has taken place. Since we are not interested in the topology of the tree, this vector alone can be used to calculate the likelihood of the tree with the function “mbd_loglik”:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_pars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.05</span>, <span class="fl">1.0</span>, <span class="fl">0.08</span>)
MBD<span class="op">::</span><span class="kw">mbd_loglik</span>(<span class="dt">pars =</span> test_pars, <span class="dt">brts =</span> sim<span class="op">$</span>brts, <span class="dt">soc =</span> soc, <span class="dt">cond =</span> cond, <span class="dt">missnumspec =</span> <span class="dv">0</span>)</code></pre></div>
<pre><code>## [1] -17.14623</code></pre>
<p>You can also ask for an optimization of the likelihood function using the function “mbd_ML” either considering a variation of all the parameters (<span class="math inline">\(\lambda, \mu, \nu, q\)</span>) or any their subset of your choice. If you want for example to maximize the likelihood only for the parameter q:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Uncomment if you are keen to wait.</span>
idparsopt &lt;-<span class="st"> </span><span class="dv">4</span>
ids &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>; idparsfix &lt;-<span class="st"> </span>ids[<span class="op">-</span>idparsopt];
parsfix &lt;-<span class="st"> </span>sim_pars[idparsfix]; initparsopt &lt;-<span class="st"> </span><span class="fl">0.15</span>;
MBD<span class="op">:::</span><span class="kw">mbd_ML</span>(<span class="dt">brts =</span> sim<span class="op">$</span>brts, <span class="dt">initparsopt =</span> initparsopt, <span class="dt">idparsopt =</span> idparsopt, <span class="dt">parsfix =</span> parsfix, <span class="dt">idparsfix =</span> idparsfix, <span class="dt">soc =</span> soc, <span class="dt">cond =</span> cond)</code></pre></div>
<pre><code>## You are optimizing q 
## You are fixing lambda mu nu 
## Optimizing the likelihood - this may take a while. 
## The loglikelihood for the initial parameter values is -13.56239 
## 1 0.15 -13.5623861582539 initial 
## 2 0.135287846481876 -13.1311274053542 expand 
## 3 0.120947368421052 -12.9095296401687 reflect 
## 4 0.113912133891213 -12.8877271529181 contract outside 
## 5 0.113912133891213 -12.8877271529181 contract inside 
## 6 0.115662650602409 -12.8871724052562 contract inside 
## 7 0.114786705051034 -12.8869359110737 contract inside 
## 8 0.11522450582537 -12.8869264384376 contract inside 
## 9 0.115005562463189 -12.8868991520931 contract inside 
## 10 0.115005562463189 -12.8868991520931 contract inside 
## 11 0.115005562463189 -12.8868991520931 contract inside 
## 12 0.115032925682032 -12.8868990642135 contract inside 
## 13 0.115019243904733 -12.8868989830906 contract inside 
## 14 0.115019243904733 -12.8868989830906 contract inside 
## 15 0.11502266431758 -12.8868989799148 contract inside 
## 16 0.115020954108534 -12.8868989795761 contract inside 
## 17 0.115021809212401 -12.8868989792276 contract inside 
## Optimization has terminated successfully. 
## 
##  Maximum likelihood parameter estimates: lambda: 0.2 mu: 0.15 nu: 2 q: 0.115021809212401 
##  Maximum loglikelihood: -12.886899</code></pre>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Etienne, R.S., Haegeman, B., Stadler, T., Aze, T., Pearson, P.N., Purvis, A., Phillimore, A.B.: Diversity-dependence brings molecular phylogenies closer to agreement with the fossil record. Proceedings of the Royal Society of London B: Biological Sciences 279(1732), 1300–1309 (2012)<a href="#fnref1">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
